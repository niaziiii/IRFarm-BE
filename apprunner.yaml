version: 1.0
runtime: nodejs20
build:
  commands:
    build:
      - echo "Installing dependencies"
      - npm install
      - echo "Installing Chromium and dependencies"
      - apt-get update
      - apt-get install -y wget gnupg
      - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -
      - sh -c 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google.list'
      - apt-get update
      - apt-get install -y google-chrome-stable
      - echo "Build completed"
run:
  runtime-version: 20
  command: npm start
  network:
    port: 8000
    env: PORT
  env:
    - name: NODE_ENV
      value: production
    - name: PUPPETEER_SKIP_CHROMIUM_DOWNLOAD
      value: "true"
    - name: PUPPETEER_EXECUTABLE_PATH
      value: "/usr/bin/google-chrome"
