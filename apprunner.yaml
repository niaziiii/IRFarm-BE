version: 1.0
runtime: nodejs20
build:
  commands:
    build:
      - echo "Installing dependencies"
      - npm install
      - echo "Installing Chromium dependencies"
      - apt-get update
      - apt-get install -y chromium libnss3 libatk-bridge2.0-0 libdrm2 libxkbcommon0 libxcomposite1 libxdamage1 libxrandr2 libgbm1 libxss1 libasound2 --no-install-recommends
      - echo "Build completed"
run:
  runtime-version: 20
  command: npm start
  network:
    port: 8000
    env: PORT
  env:
    - name: NODE_ENV
      value: production
    - name: PUPPETEER_SKIP_CHROMIUM_DOWNLOAD
      value: "true"
    - name: PUPPETEER_EXECUTABLE_PATH
      value: "/usr/bin/chromium"
